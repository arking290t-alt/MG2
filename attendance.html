<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attendance | MG</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="staff-body">

  <!-- HEADER -->
  <header class="top-bar">
    <div class="top-left">
      <h1 class="logo">MG</h1>
    </div>
    <div class="top-right">
      <a href="dashboard.html" class="btn-back">‚Üê Dashboard</a>
      <button id="logoutBtn" class="btn-logout">Logout</button>
    </div>
  </header>

  <!-- MAIN CONTENT -->
  <main class="center-stage">
    <section class="staff-card-panel">
      <h2 class="panel-title">Staff Attendance</h2>
      <p class="panel-sub">Mark daily attendance and review history</p>

      <!-- Attendance Form -->
      <form id="attendanceForm" class="staff-form">
        <input type="text" id="staffName" placeholder="Staff name" required />
        <select id="status" required>
          <option value="">Select Status</option>
          <option value="Present">‚úÖ Present</option>
          <option value="Absent">‚ùå Absent</option>
          <option value="Leave">üïê Leave</option>
        </select>
        <button type="submit" class="add-btn">Mark Attendance</button>
      </form>

      <!-- Attendance List -->
      <div id="attendanceContainer" class="staff-list">
        <!-- Dynamic records -->
      </div>
    </section>
  </main>

  <script>
    // üß† Attendance Script
    const form = document.getElementById("attendanceForm");
    const nameInput = document.getElementById("staffName");
    const statusSelect = document.getElementById("status");
    const container = document.getElementById("attendanceContainer");

    function loadAttendance() {
      const data = JSON.parse(localStorage.getItem("attendance")) || [];
      container.innerHTML = "";
      if (data.length === 0) {
        container.innerHTML = "<p style='text-align:center;color:#888;'>No attendance records yet</p>";
        return;
      }

      data.forEach((entry, index) => {
        const div = document.createElement("div");
        div.classList.add("staff-item");
        div.innerHTML = `
          <span><strong>${entry.name}</strong> - ${entry.status}</span>
          <span style="font-size:0.9rem;color:#aaa;">${entry.date}</span>
          <button data-index="${index}" class="delete-btn">üóë</button>
        `;
        container.appendChild(div);
      });

      // Add delete functionality
      document.querySelectorAll(".delete-btn").forEach(btn => {
        btn.addEventListener("click", (e) => {
          const idx = e.target.getAttribute("data-index");
          const data = JSON.parse(localStorage.getItem("attendance")) || [];
          data.splice(idx, 1);
          localStorage.setItem("attendance", JSON.stringify(data));
          loadAttendance();
        });
      });
    }

    form.addEventListener("submit", (e) => {
      e.preventDefault();
      const name = nameInput.value.trim();
      const status = statusSelect.value;
      if (!name || !status) return;

      const today = new Date();
      const date = today.toLocaleDateString("en-IN", {
        day: "2-digit",
        month: "short",
        year: "numeric",
      });

      const record = { name, status, date };
      const data = JSON.parse(localStorage.getItem("attendance")) || [];
      data.push(record);
      localStorage.setItem("attendance", JSON.stringify(data));

      nameInput.value = "";
      statusSelect.value = "";
      loadAttendance();
    });

    loadAttendance();
  </script>

</body>
</html>
