<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MG Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ================= BASE ================= */
body {
  margin: 0;
  font-family: Poppins, sans-serif;
  background: radial-gradient(circle at top right, #0b1118, #080b10);
  color: #e5eaf0;
}

/* ================= HEADER ================= */
header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 30px;
  background: rgba(255,255,255,0.04);
  border-bottom: 1px solid rgba(255,255,255,0.1);
}

.logo {
  font-size: 26px;
  font-weight: 700;
  color: #00b4ff;
}

/* ================= DASHBOARD ================= */
.dashboard {
  padding: 40px;
  padding-right: 380px; /* IMPORTANT: space for AI */
}

.cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px,1fr));
  gap: 25px;
}

.card {
  background: rgba(255,255,255,0.06);
  border-radius: 18px;
  padding: 25px;
  text-align: center;
  transition: 0.3s;
  cursor: pointer;
}

.card:hover {
  transform: translateY(-6px);
  box-shadow: 0 0 25px rgba(0,180,255,0.35);
}

.card h3 {
  color: #00b4ff;
  margin-bottom: 8px;
}

/* ================= AI BUTTON ================= */
#ai-toggle {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background: #00b4ff;
  border: none;
  cursor: pointer;
  font-size: 24px;
  color: #001;
  z-index: 1000;
  box-shadow: 0 0 20px rgba(0,180,255,0.6);
}

/* ================= AI PANEL ================= */
#ai-container {
  position: fixed;
  bottom: 90px;
  right: 30px;
  width: 320px;
  height: 420px;
  background: #0f1724;
  border-radius: 18px;
  box-shadow: 0 0 35px rgba(0,180,255,0.45);
  display: none;
  z-index: 999;
  overflow: hidden;
}

#ai-header {
  background: #00b4ff;
  color: #001;
  padding: 12px;
  font-weight: 700;
  text-align: center;
}

#ai-messages {
  height: 300px;
  overflow-y: auto;
  padding: 12px;
  font-size: 14px;
}

.msg-user { color:#9fb6d4; margin-bottom:6px; }
.msg-ai { color:#00b4ff; margin-bottom:12px; }

#ai-input {
  display: flex;
  border-top: 1px solid rgba(255,255,255,0.1);
}

#ai-input input {
  flex: 1;
  padding: 12px;
  border: none;
  background: transparent;
  color: white;
  outline: none;
}

#ai-input button {
  background: #00b4ff;
  border: none;
  padding: 12px 16px;
  cursor: pointer;
  font-weight: 700;
}

/* ================= MOBILE ================= */
@media(max-width:768px){
  .dashboard {
    padding-right: 40px;
  }
  #ai-container {
    right: 10px;
    width: 92%;
  }
}
</style>
</head>

<body>

<header>
  <div class="logo">MG Dashboard</div>
</header>

<!-- ================= DASHBOARD CONTENT ================= -->
<div class="dashboard">
  <div class="cards">
    <div class="card"><h3>Inventory</h3><p>Manage stock</p></div>
    <div class="card"><h3>Jobs</h3><p>Production tracking</p></div>
    <div class="card"><h3>Staff</h3><p>Attendance & salary</p></div>
    <div class="card"><h3>Reports</h3><p>PDF & analytics</p></div>
  </div>
</div>

<!-- ================= AI UI ================= -->
<button id="ai-toggle">ðŸ¤–</button>

<div id="ai-container">
  <div id="ai-header">MG AI Assistant</div>
  <div id="ai-messages"></div>
  <div id="ai-input">
    <input id="ai-text" placeholder="Ask anythingâ€¦" />
    <button id="ai-send">âž¤</button>
  </div>
</div>

<!-- ================= AI SCRIPT ================= -->
<script>
const AI_API_URL = "https://ai-backend.arking290t.workers.dev/";

const aiBox = document.getElementById("ai-container");
const toggle = document.getElementById("ai-toggle");
const sendBtn = document.getElementById("ai-send");
const input = document.getElementById("ai-text");
const messages = document.getElementById("ai-messages");

toggle.onclick = () => {
  aiBox.style.display = aiBox.style.display === "none" ? "block" : "none";
};

sendBtn.onclick = sendMessage;
input.addEventListener("keydown", e => e.key === "Enter" && sendMessage());

async function sendMessage() {
  const text = input.value.trim();
  if (!text) return;

  messages.innerHTML += `<div class="msg-user"><b>You:</b> ${text}</div>`;
  input.value = "";

  try {
    const res = await fetch(AI_API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ message: text })
    });

    const data = await res.json();
    messages.innerHTML += `<div class="msg-ai"><b>AI:</b> ${data.reply}</div>`;
    messages.scrollTop = messages.scrollHeight;

  } catch (e) {
    messages.innerHTML += `<div class="msg-ai">AI error. Try again.</div>`;
  }
}
</script>

</body>
</html>

